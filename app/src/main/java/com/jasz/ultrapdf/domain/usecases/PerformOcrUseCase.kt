package com.jasz.ultrapdf.domain.usecases\n\nimport android.content.Context\nimport android.net.Uri\nimport com.google.mlkit.vision.common.InputImage\nimport com.google.mlkit.vision.text.TextRecognition\nimport com.google.mlkit.vision.text.TextRecognizer\nimport com.google.mlkit.vision.text.devanagari.DevanagariTextRecognizerOptions\nimport dagger.hilt.android.qualifiers.ApplicationContext\nimport kotlinx.coroutines.suspendCancellableCoroutine\nimport javax.inject.Inject\nimport kotlin.coroutines.resume\nimport kotlin.coroutines.resumeWithException\n\nclass PerformOcrUseCase @Inject constructor(\n    @ApplicationContext private val context: Context\n) {\n    suspend operator fun invoke(imageUri: Uri): String {\n        val image = InputImage.fromFilePath(context, imageUri)\n        val recognizer: TextRecognizer = TextRecognition.getClient(DevanagariTextRecognizerOptions.Builder().build())\n\n        return suspendCancellableCoroutine {\ continuation ->\n            recognizer.process(image)\n                .addOnSuccessListener { visionText ->\n                    continuation.resume(visionText.text)\n                }\n                .addOnFailureListener { e ->\n                    continuation.resumeWithException(e)\n                }\n        }\n    }\n}\n